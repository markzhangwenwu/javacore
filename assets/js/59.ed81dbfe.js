(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{337:function(a,t,s){"use strict";s.r(t);var n=s(11),e=Object(n.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"java-å†…å­˜ç®¡ç†"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java-å†…å­˜ç®¡ç†"}},[a._v("#")]),a._v(" Java å†…å­˜ç®¡ç†")]),a._v(" "),s("blockquote",[s("p",[s("strong",[a._v("ğŸ“¦ æœ¬æ–‡ä»¥åŠç¤ºä¾‹æºç å·²å½’æ¡£åœ¨ "),s("a",{attrs:{href:"https://github.com/dunwu/javacore/",target:"_blank",rel:"noopener noreferrer"}},[a._v("javacore"),s("OutboundLink")],1)])])]),a._v(" "),s("h2",{attrs:{id:"ä¸€ã€å†…å­˜ç®€ä»‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸€ã€å†…å­˜ç®€ä»‹"}},[a._v("#")]),a._v(" ä¸€ã€å†…å­˜ç®€ä»‹")]),a._v(" "),s("h3",{attrs:{id:"ç‰©ç†å†…å­˜å’Œè™šæ‹Ÿå†…å­˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç‰©ç†å†…å­˜å’Œè™šæ‹Ÿå†…å­˜"}},[a._v("#")]),a._v(" ç‰©ç†å†…å­˜å’Œè™šæ‹Ÿå†…å­˜")]),a._v(" "),s("p",[a._v("æ‰€è°“ç‰©ç†å†…å­˜å°±æ˜¯é€šå¸¸æ‰€è¯´çš„ RAMï¼ˆéšæœºå­˜å‚¨å™¨ï¼‰ã€‚")]),a._v(" "),s("p",[a._v("è™šæ‹Ÿå†…å­˜ä½¿å¾—å¤šä¸ªè¿›ç¨‹åœ¨åŒæ—¶è¿è¡Œæ—¶å¯ä»¥å…±äº«ç‰©ç†å†…å­˜ï¼Œè¿™é‡Œçš„å…±äº«åªæ˜¯ç©ºé—´ä¸Šå…±äº«ï¼Œåœ¨é€»è¾‘ä¸Šå½¼æ­¤ä»ç„¶æ˜¯éš”ç¦»çš„ã€‚")]),a._v(" "),s("h3",{attrs:{id:"å†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´"}},[a._v("#")]),a._v(" å†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´")]),a._v(" "),s("p",[a._v("ä¸€ä¸ªè®¡ç®—é€šå¸¸æœ‰å›ºå®šå¤§å°çš„å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯ç¨‹åºå¹¶ä¸èƒ½ä½¿ç”¨å…¨éƒ¨çš„ç©ºé—´ã€‚å› ä¸ºè¿™äº›ç©ºé—´è¢«åˆ’åˆ†ä¸ºå†…æ ¸ç©ºé—´å’Œç”¨æˆ·ç©ºé—´ï¼Œè€Œç¨‹åºåªèƒ½ä½¿ç”¨ç”¨æˆ·ç©ºé—´çš„å†…å­˜ã€‚")]),a._v(" "),s("h3",{attrs:{id:"ä½¿ç”¨å†…å­˜çš„-java-ç»„ä»¶"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä½¿ç”¨å†…å­˜çš„-java-ç»„ä»¶"}},[a._v("#")]),a._v(" ä½¿ç”¨å†…å­˜çš„ Java ç»„ä»¶")]),a._v(" "),s("p",[a._v("Java å¯åŠ¨åï¼Œä½œä¸ºä¸€ä¸ªè¿›ç¨‹è¿è¡Œåœ¨æ“ä½œç³»ç»Ÿä¸­ã€‚")]),a._v(" "),s("p",[a._v("æœ‰å“ªäº› Java ç»„ä»¶éœ€è¦å ç”¨å†…å­˜å‘¢ï¼Ÿ")]),a._v(" "),s("ul",[s("li",[a._v("å †å†…å­˜ï¼šJava å †ã€ç±»å’Œç±»åŠ è½½å™¨")]),a._v(" "),s("li",[a._v("æ ˆå†…å­˜ï¼šçº¿ç¨‹")]),a._v(" "),s("li",[a._v("æœ¬åœ°å†…å­˜ï¼šNIOã€JNI")])]),a._v(" "),s("h2",{attrs:{id:"äºŒã€è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#äºŒã€è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ"}},[a._v("#")]),a._v(" äºŒã€è¿è¡Œæ—¶æ•°æ®åŒºåŸŸ")]),a._v(" "),s("p",[a._v("JVM åœ¨æ‰§è¡Œ Java ç¨‹åºçš„è¿‡ç¨‹ä¸­ä¼šæŠŠå®ƒæ‰€ç®¡ç†çš„å†…å­˜åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªä¸åŒçš„æ•°æ®åŒºåŸŸã€‚è¿™äº›åŒºåŸŸéƒ½æœ‰å„è‡ªçš„ç”¨é€”ï¼Œä»¥åŠåˆ›å»ºå’Œé”€æ¯çš„æ—¶é—´ï¼Œæœ‰çš„åŒºåŸŸéšç€è™šæ‹Ÿæœºè¿›ç¨‹çš„å¯åŠ¨è€Œå­˜åœ¨ï¼Œæœ‰äº›åŒºåŸŸåˆ™ä¾èµ–ç”¨æˆ·çº¿ç¨‹çš„å¯åŠ¨å’Œç»“æŸè€Œå»ºç«‹å’Œé”€æ¯ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š")]),a._v(" "),s("p",[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/java/javacore/jvm/jvm-memory-runtime-data-area.png!zp",alt:"img"}})]),a._v(" "),s("h3",{attrs:{id:"ç¨‹åºè®¡æ•°å™¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç¨‹åºè®¡æ•°å™¨"}},[a._v("#")]),a._v(" ç¨‹åºè®¡æ•°å™¨")]),a._v(" "),s("p",[s("strong",[s("code",[a._v("ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰")])]),a._v(" æ˜¯ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œå®ƒå¯ä»¥çœ‹åšæ˜¯"),s("strong",[a._v("å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨")]),a._v("ã€‚")]),a._v(" "),s("p",[a._v("ä¸ºäº†çº¿ç¨‹åˆ‡æ¢åèƒ½æ¢å¤åˆ°æ­£ç¡®çš„æ‰§è¡Œä½ç½®ï¼Œæ¯æ¡çº¿ç¨‹éƒ½éœ€è¦ä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºè®¡æ•°å™¨ï¼Œå„æ¡çº¿ç¨‹é—´çš„è®¡æ•°å™¨äº’ä¸å½±å“ï¼Œç‹¬ç«‹å­˜å‚¨ï¼Œæˆ‘ä»¬ç§°è¿™ç±»å†…å­˜åŒºåŸŸä¸º â€œçº¿ç¨‹ç§æœ‰â€ çš„å†…å­˜ã€‚")]),a._v(" "),s("ul",[s("li",[a._v("å¦‚æœçº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æ˜¯ä¸€ä¸ª Java æ–¹æ³•ï¼Œè¿™ä¸ªè®¡æ•°å™¨è®°å½•çš„æ˜¯æ­£åœ¨æ‰§è¡Œçš„è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼›")]),a._v(" "),s("li",[a._v("å¦‚æœæ­£åœ¨æ‰§è¡Œçš„æ˜¯ Native æ–¹æ³•ï¼Œè¿™ä¸ªè®¡æ•°å™¨å€¼åˆ™ä¸ºç©ºï¼ˆUndefinedï¼‰ã€‚")])]),a._v(" "),s("blockquote",[s("p",[a._v("ğŸ”” æ³¨æ„ï¼šæ­¤å†…å­˜åŒºåŸŸæ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨ JVM ä¸­æ²¡æœ‰è§„å®šä»»ä½• "),s("code",[a._v("OutOfMemoryError")]),a._v(" æƒ…å†µçš„åŒºåŸŸã€‚")])]),a._v(" "),s("h3",{attrs:{id:"java-è™šæ‹Ÿæœºæ ˆ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java-è™šæ‹Ÿæœºæ ˆ"}},[a._v("#")]),a._v(" Java è™šæ‹Ÿæœºæ ˆ")]),a._v(" "),s("p",[s("strong",[s("code",[a._v("Java è™šæ‹Ÿæœºæ ˆï¼ˆJava Virtual Machine Stacksï¼‰")])]),a._v(" ä¹Ÿ"),s("strong",[a._v("æ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ç›¸åŒ")]),a._v("ã€‚")]),a._v(" "),s("p",[a._v("æ¯ä¸ª Java æ–¹æ³•åœ¨æ‰§è¡Œçš„åŒæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼ˆStack Frameï¼‰ç”¨äºå­˜å‚¨ "),s("strong",[a._v("å±€éƒ¨å˜é‡è¡¨")]),a._v("ã€"),s("strong",[a._v("æ“ä½œæ•°æ ˆ")]),a._v("ã€"),s("strong",[a._v("å¸¸é‡æ± å¼•ç”¨")]),a._v(" ç­‰ä¿¡æ¯ã€‚æ¯ä¸€ä¸ªæ–¹æ³•ä»è°ƒç”¨ç›´è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹ï¼Œå°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨ Java è™šæ‹Ÿæœºæ ˆä¸­å…¥æ ˆå’Œå‡ºæ ˆçš„è¿‡ç¨‹ã€‚")]),a._v(" "),s("p",[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/java/javacore/jvm/jvm-stack.png!w640",alt:"img"}})]),a._v(" "),s("blockquote",[s("p",[a._v("ğŸ”” æ³¨æ„ï¼š")]),a._v(" "),s("p",[a._v("è¯¥åŒºåŸŸå¯èƒ½æŠ›å‡ºä»¥ä¸‹å¼‚å¸¸ï¼š")]),a._v(" "),s("ul",[s("li",[a._v("å¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦è¶…è¿‡æœ€å¤§å€¼ï¼Œå°±ä¼šæŠ›å‡º "),s("code",[a._v("StackOverflowError")]),a._v(" å¼‚å¸¸ï¼›")]),a._v(" "),s("li",[a._v("å¦‚æœè™šæ‹Ÿæœºæ ˆè¿›è¡ŒåŠ¨æ€æ‰©å±•æ—¶ï¼Œæ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿå†…å­˜ï¼Œå°±ä¼šæŠ›å‡º "),s("code",[a._v("OutOfMemoryError")]),a._v(" å¼‚å¸¸ã€‚")])]),a._v(" "),s("p",[a._v("ğŸ’¡ æç¤ºï¼š")]),a._v(" "),s("p",[a._v("å¯ä»¥é€šè¿‡ "),s("code",[a._v("-Xss")]),a._v(" è¿™ä¸ªè™šæ‹Ÿæœºå‚æ•°æ¥æŒ‡å®šä¸€ä¸ªç¨‹åºçš„ Java è™šæ‹Ÿæœºæ ˆå†…å­˜å¤§å°ï¼š")]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("java "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Xss")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("512")]),a._v("M "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("HackTheJava")]),a._v("\n")])])])]),a._v(" "),s("h3",{attrs:{id:"æœ¬åœ°æ–¹æ³•æ ˆ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æœ¬åœ°æ–¹æ³•æ ˆ"}},[a._v("#")]),a._v(" æœ¬åœ°æ–¹æ³•æ ˆ")]),a._v(" "),s("p",[s("strong",[s("code",[a._v("æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰")])]),a._v(" ä¸è™šæ‹Ÿæœºæ ˆçš„ä½œç”¨ç›¸ä¼¼ã€‚")]),a._v(" "),s("p",[a._v("äºŒè€…çš„åŒºåˆ«åœ¨äºï¼š"),s("strong",[a._v("è™šæ‹Ÿæœºæ ˆä¸º Java æ–¹æ³•æœåŠ¡ï¼›æœ¬åœ°æ–¹æ³•æ ˆä¸º Native æ–¹æ³•æœåŠ¡")]),a._v("ã€‚")]),a._v(" "),s("p",[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/java/javacore/jvm/jvm-native-method-stack.gif!w640",alt:"img"}})]),a._v(" "),s("blockquote",[s("p",[a._v("ğŸ”” æ³¨æ„ï¼šæœ¬åœ°æ–¹æ³•æ ˆä¹Ÿä¼šæŠ›å‡º "),s("code",[a._v("StackOverflowError")]),a._v(" å¼‚å¸¸å’Œ "),s("code",[a._v("OutOfMemoryError")]),a._v(" å¼‚å¸¸ã€‚")])]),a._v(" "),s("h3",{attrs:{id:"java-å †"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java-å †"}},[a._v("#")]),a._v(" Java å †")]),a._v(" "),s("p",[s("strong",[s("code",[a._v("Java å †ï¼ˆJava Heapï¼‰")]),a._v(" çš„ä½œç”¨å°±æ˜¯å­˜æ”¾å¯¹è±¡å®ä¾‹ï¼Œå‡ ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹éƒ½æ˜¯åœ¨è¿™é‡Œåˆ†é…å†…å­˜")]),a._v("ã€‚")]),a._v(" "),s("p",[a._v('Java å †æ˜¯åƒåœ¾æ”¶é›†çš„ä¸»è¦åŒºåŸŸï¼ˆå› æ­¤ä¹Ÿè¢«å«åš"GC å †"ï¼‰ã€‚ç°ä»£çš„åƒåœ¾æ”¶é›†å™¨åŸºæœ¬éƒ½æ˜¯é‡‡ç”¨'),s("strong",[a._v("åˆ†ä»£æ”¶é›†ç®—æ³•")]),a._v("ï¼Œè¯¥ç®—æ³•çš„æ€æƒ³æ˜¯é’ˆå¯¹ä¸åŒçš„å¯¹è±¡é‡‡å–ä¸åŒçš„åƒåœ¾å›æ”¶ç®—æ³•ã€‚")]),a._v(" "),s("p",[a._v("å› æ­¤è™šæ‹ŸæœºæŠŠ Java å †åˆ†æˆä»¥ä¸‹ä¸‰å—ï¼š")]),a._v(" "),s("ul",[s("li",[s("strong",[s("code",[a._v("æ–°ç”Ÿä»£ï¼ˆYoung Generationï¼‰")])]),a._v(" "),s("ul",[s("li",[s("code",[a._v("Eden")])]),a._v(" "),s("li",[s("code",[a._v("From Survivor")])]),a._v(" "),s("li",[s("code",[a._v("To Survivor")])])])]),a._v(" "),s("li",[s("strong",[s("code",[a._v("è€å¹´ä»£ï¼ˆOld Generationï¼‰")])])]),a._v(" "),s("li",[s("strong",[s("code",[a._v("æ°¸ä¹…ä»£ï¼ˆPermanent Generationï¼‰")])])])]),a._v(" "),s("p",[a._v("å½“ä¸€ä¸ªå¯¹è±¡è¢«åˆ›å»ºæ—¶ï¼Œå®ƒé¦–å…ˆè¿›å…¥æ–°ç”Ÿä»£ï¼Œä¹‹åæœ‰å¯èƒ½è¢«è½¬ç§»åˆ°è€å¹´ä»£ä¸­ã€‚æ–°ç”Ÿä»£å­˜æ”¾ç€å¤§é‡çš„ç”Ÿå‘½å¾ˆçŸ­çš„å¯¹è±¡ï¼Œå› æ­¤æ–°ç”Ÿä»£åœ¨ä¸‰ä¸ªåŒºåŸŸä¸­åƒåœ¾å›æ”¶çš„é¢‘ç‡æœ€é«˜ã€‚")]),a._v(" "),s("p",[s("img",{attrs:{src:"http://dunwu.test.upcdn.net/cs/java/javacore/jvm/jvm-heap.gif!w640",alt:"img"}})]),a._v(" "),s("blockquote",[s("p",[a._v("ğŸ”” æ³¨æ„ï¼šJava å †ä¸éœ€è¦è¿ç»­å†…å­˜ï¼Œå¹¶ä¸”å¯ä»¥åŠ¨æ€æ‰©å±•å…¶å†…å­˜ï¼Œæ‰©å±•å¤±è´¥ä¼šæŠ›å‡º "),s("code",[a._v("OutOfMemoryError")]),a._v(" å¼‚å¸¸ã€‚")]),a._v(" "),s("p",[a._v("ğŸ’¡ æç¤ºï¼šå¯ä»¥é€šè¿‡ "),s("code",[a._v("-Xms")]),a._v(" å’Œ "),s("code",[a._v("-Xmx")]),a._v(" ä¸¤ä¸ªè™šæ‹Ÿæœºå‚æ•°æ¥æŒ‡å®šä¸€ä¸ªç¨‹åºçš„ Java å †å†…å­˜å¤§å°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°è®¾ç½®åˆå§‹å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°è®¾ç½®æœ€å¤§å€¼ã€‚")]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[a._v("java "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Xms")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("M "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Xmx")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("M "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("HackTheJava")]),a._v("\n")])])])]),a._v(" "),s("h3",{attrs:{id:"æ–¹æ³•åŒº"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ–¹æ³•åŒº"}},[a._v("#")]),a._v(" æ–¹æ³•åŒº")]),a._v(" "),s("p",[s("strong",[s("code",[a._v("æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰")]),a._v(" ç”¨äºå­˜æ”¾å·²è¢«åŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®")]),a._v("ã€‚")]),a._v(" "),s("p",[a._v("å¯¹è¿™å—åŒºåŸŸè¿›è¡Œåƒåœ¾å›æ”¶çš„ä¸»è¦ç›®æ ‡æ˜¯å¯¹å¸¸é‡æ± çš„å›æ”¶å’Œå¯¹ç±»çš„å¸è½½ï¼Œä½†æ˜¯ä¸€èˆ¬æ¯”è¾ƒéš¾å®ç°ã€‚")]),a._v(" "),s("blockquote",[s("p",[a._v("ğŸ”” æ³¨æ„ï¼šå’Œ Java å †ä¸€æ ·ä¸éœ€è¦è¿ç»­çš„å†…å­˜ï¼Œå¹¶ä¸”å¯ä»¥åŠ¨æ€æ‰©å±•ï¼ŒåŠ¨æ€æ‰©å±•å¤±è´¥ä¸€æ ·ä¼šæŠ›å‡º "),s("code",[a._v("OutOfMemoryError")]),a._v(" å¼‚å¸¸ã€‚")]),a._v(" "),s("p",[a._v("ğŸ’¡ æç¤ºï¼šJDK 1.7 ä¹‹å‰ï¼ŒHotSpot è™šæ‹ŸæœºæŠŠå®ƒå½“æˆæ°¸ä¹…ä»£æ¥è¿›è¡Œåƒåœ¾å›æ”¶ï¼ŒJDK 1.8 ä¹‹åï¼Œå–æ¶ˆäº†æ°¸ä¹…ä»£ï¼Œç”¨ **"),s("code",[a._v("metaspaceï¼ˆå…ƒæ•°æ®ï¼‰")]),a._v("**åŒºæ›¿ä»£ã€‚")])]),a._v(" "),s("h3",{attrs:{id:"è¿è¡Œæ—¶å¸¸é‡æ± "}},[s("a",{staticClass:"header-anchor",attrs:{href:"#è¿è¡Œæ—¶å¸¸é‡æ± "}},[a._v("#")]),a._v(" è¿è¡Œæ—¶å¸¸é‡æ± ")]),a._v(" "),s("p",[s("strong",[s("code",[a._v("è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰")]),a._v(" æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†")]),a._v("ï¼ŒClass æ–‡ä»¶ä¸­é™¤äº†æœ‰ç±»çš„ç‰ˆæœ¬ã€å­—æ®µã€æ–¹æ³•ã€æ¥å£ç­‰æè¿°ä¿¡æ¯ï¼Œè¿˜æœ‰ä¸€é¡¹ä¿¡æ¯æ˜¯å¸¸é‡æ± ï¼ˆConstant Pool Tableï¼‰ï¼Œ"),s("strong",[a._v("ç”¨äºå­˜æ”¾ç¼–è¯‘å™¨ç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨")]),a._v("ï¼Œè¿™éƒ¨åˆ†å†…å®¹ä¼šåœ¨ç±»åŠ è½½åè¢«æ”¾å…¥è¿™ä¸ªåŒºåŸŸã€‚")]),a._v(" "),s("p",[a._v("é™¤äº†åœ¨ç¼–è¯‘æœŸç”Ÿæˆçš„å¸¸é‡ï¼Œè¿˜å…è®¸åŠ¨æ€ç”Ÿæˆï¼Œä¾‹å¦‚ "),s("code",[a._v("String")]),a._v(" ç±»çš„ "),s("code",[a._v("intern()")]),a._v("ã€‚è¿™éƒ¨åˆ†å¸¸é‡ä¹Ÿä¼šè¢«æ”¾å…¥è¿è¡Œæ—¶å¸¸é‡æ± ã€‚")]),a._v(" "),s("blockquote",[s("p",[a._v("ğŸ”” æ³¨æ„ï¼šå½“å¸¸é‡æ± æ— æ³•å†ç”³è¯·åˆ°å†…å­˜æ—¶ä¼šæŠ›å‡º "),s("code",[a._v("OutOfMemoryError")]),a._v(" å¼‚å¸¸ã€‚")])]),a._v(" "),s("h3",{attrs:{id:"ç›´æ¥å†…å­˜"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç›´æ¥å†…å­˜"}},[a._v("#")]),a._v(" ç›´æ¥å†…å­˜")]),a._v(" "),s("p",[a._v("ç›´æ¥å†…å­˜ï¼ˆDirect Memoryï¼‰å¹¶ä¸æ˜¯è™šæ‹Ÿæœºè¿è¡Œæ—¶æ•°æ®åŒºçš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿä¸æ˜¯ JVM è§„èŒƒä¸­å®šä¹‰çš„å†…å­˜åŒºåŸŸã€‚")]),a._v(" "),s("p",[a._v("åœ¨ JDK 1.4 ä¸­æ–°åŠ å…¥äº† NIO ç±»ï¼Œå®ƒå¯ä»¥ä½¿ç”¨ Native å‡½æ•°åº“ç›´æ¥åˆ†é…å †å¤–å†…å­˜ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªå­˜å‚¨åœ¨ Java å †é‡Œçš„ "),s("code",[a._v("DirectByteBuffer")]),a._v(" å¯¹è±¡ä½œä¸ºè¿™å—å†…å­˜çš„å¼•ç”¨è¿›è¡Œæ“ä½œã€‚è¿™æ ·èƒ½åœ¨ä¸€äº›åœºæ™¯ä¸­æ˜¾è‘—æé«˜æ€§èƒ½ï¼Œå› ä¸ºé¿å…äº†åœ¨ Java å †å’Œ Native å †ä¸­æ¥å›å¤åˆ¶æ•°æ®ã€‚")]),a._v(" "),s("blockquote",[s("p",[a._v("ğŸ”” æ³¨æ„ï¼šç›´æ¥å†…å­˜è¿™éƒ¨åˆ†ä¹Ÿè¢«é¢‘ç¹çš„ä½¿ç”¨ï¼Œä¸”ä¹Ÿå¯èƒ½å¯¼è‡´ "),s("code",[a._v("OutOfMemoryError")]),a._v(" å¼‚å¸¸ã€‚")]),a._v(" "),s("p",[a._v("ğŸ’¡ æç¤ºï¼šç›´æ¥å†…å­˜å®¹é‡å¯é€šè¿‡ "),s("code",[a._v("-XX:MaxDirectMemorySize")]),a._v(" æŒ‡å®šï¼Œå¦‚æœä¸æŒ‡å®šï¼Œåˆ™é»˜è®¤ä¸ Java å †æœ€å¤§å€¼ï¼ˆ"),s("code",[a._v("-Xmx")]),a._v(" æŒ‡å®šï¼‰ä¸€æ ·ã€‚")])]),a._v(" "),s("h3",{attrs:{id:"java-å†…å­˜åŒºåŸŸå¯¹æ¯”"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java-å†…å­˜åŒºåŸŸå¯¹æ¯”"}},[a._v("#")]),a._v(" Java å†…å­˜åŒºåŸŸå¯¹æ¯”")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("å†…å­˜åŒºåŸŸ")]),a._v(" "),s("th",[a._v("å†…å­˜ä½œç”¨èŒƒå›´")]),a._v(" "),s("th",[a._v("å¼‚å¸¸")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("ç¨‹åºè®¡æ•°å™¨")]),a._v(" "),s("td",[a._v("çº¿ç¨‹ç§æœ‰")]),a._v(" "),s("td",[a._v("æ— ")])]),a._v(" "),s("tr",[s("td",[a._v("Java è™šæ‹Ÿæœºæ ˆ")]),a._v(" "),s("td",[a._v("çº¿ç¨‹ç§æœ‰")]),a._v(" "),s("td",[s("code",[a._v("StackOverflowError")]),a._v(" å’Œ "),s("code",[a._v("OutOfMemoryError")])])]),a._v(" "),s("tr",[s("td",[a._v("æœ¬åœ°æ–¹æ³•æ ˆ")]),a._v(" "),s("td",[a._v("çº¿ç¨‹ç§æœ‰")]),a._v(" "),s("td",[s("code",[a._v("StackOverflowError")]),a._v(" å’Œ "),s("code",[a._v("OutOfMemoryError")])])]),a._v(" "),s("tr",[s("td",[a._v("Java å †")]),a._v(" "),s("td",[a._v("çº¿ç¨‹å…±äº«")]),a._v(" "),s("td",[s("code",[a._v("OutOfMemoryError")])])]),a._v(" "),s("tr",[s("td",[a._v("æ–¹æ³•åŒº")]),a._v(" "),s("td",[a._v("çº¿ç¨‹å…±äº«")]),a._v(" "),s("td",[s("code",[a._v("OutOfMemoryError")])])]),a._v(" "),s("tr",[s("td",[a._v("è¿è¡Œæ—¶å¸¸é‡æ± ")]),a._v(" "),s("td",[a._v("çº¿ç¨‹å…±äº«")]),a._v(" "),s("td",[s("code",[a._v("OutOfMemoryError")])])]),a._v(" "),s("tr",[s("td",[a._v("ç›´æ¥å†…å­˜")]),a._v(" "),s("td",[a._v("éè¿è¡Œæ—¶æ•°æ®åŒº")]),a._v(" "),s("td",[s("code",[a._v("OutOfMemoryError")])])])])]),a._v(" "),s("h2",{attrs:{id:"ä¸‰ã€outofmemoryerror"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ä¸‰ã€outofmemoryerror"}},[a._v("#")]),a._v(" ä¸‰ã€OutOfMemoryError")]),a._v(" "),s("p",[a._v("åœ¨ JVM è§„èŒƒä¸­ï¼Œ"),s("strong",[a._v("é™¤äº†ç¨‹åºè®¡æ•°å™¨åŒºåŸŸå¤–ï¼Œå…¶ä»–è¿è¡Œæ—¶åŒºåŸŸéƒ½å¯èƒ½å‘ç”Ÿ "),s("code",[a._v("OutOfMemoryError")]),a._v(" å¼‚å¸¸ï¼ˆç®€ç§° OOMï¼‰")]),a._v("ã€‚")]),a._v(" "),s("p",[a._v("ä¸‹é¢é€ä¸€ä»‹ç» OOM å‘ç”Ÿåœºæ™¯ã€‚")]),a._v(" "),s("h3",{attrs:{id:"java-heap-space"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java-heap-space"}},[a._v("#")]),a._v(" Java heap space")]),a._v(" "),s("p",[s("code",[a._v("java.lang.OutOfMemoryError: Java heap space")]),a._v(" è¿™ä¸ªé”™è¯¯æ„å‘³ç€ï¼š"),s("strong",[a._v("å †ç©ºé—´æº¢å‡º")]),a._v("ã€‚")]),a._v(" "),s("p",[a._v("æ›´ç»†è‡´çš„è¯´æ³•æ˜¯ï¼šJava å †å†…å­˜å·²ç»è¾¾åˆ° "),s("code",[a._v("-Xmx")]),a._v(" è®¾ç½®çš„æœ€å¤§å€¼ã€‚Java å †ç”¨äºå­˜å‚¨å¯¹è±¡å®ä¾‹ï¼Œåªè¦ä¸æ–­åœ°åˆ›å»ºå¯¹è±¡ï¼Œå¹¶ä¸”ä¿è¯ GC Roots åˆ°å¯¹è±¡ä¹‹é—´æœ‰å¯è¾¾è·¯å¾„æ¥é¿å…åƒåœ¾æ”¶é›†å™¨å›æ”¶è¿™äº›å¯¹è±¡ï¼Œé‚£ä¹ˆå½“å †ç©ºé—´åˆ°è¾¾æœ€å¤§å®¹é‡é™åˆ¶åå°±ä¼šäº§ç”Ÿ OOMã€‚")]),a._v(" "),s("p",[a._v("å †ç©ºé—´æº¢å‡ºæœ‰å¯èƒ½æ˜¯**"),s("code",[a._v("å†…å­˜æ³„æ¼ï¼ˆMemory Leakï¼‰")]),a._v("** æˆ– "),s("strong",[s("code",[a._v("å†…å­˜æº¢å‡ºï¼ˆMemory Overflowï¼‰")])]),a._v(" ã€‚éœ€è¦ä½¿ç”¨ jstack å’Œ jmap ç”Ÿæˆ threaddump å’Œ heapdumpï¼Œç„¶åç”¨å†…å­˜åˆ†æå·¥å…·ï¼ˆå¦‚ï¼šMATï¼‰è¿›è¡Œåˆ†æã€‚")]),a._v(" "),s("h4",{attrs:{id:"java-heap-space-åˆ†ææ­¥éª¤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#java-heap-space-åˆ†ææ­¥éª¤"}},[a._v("#")]),a._v(" Java heap space åˆ†ææ­¥éª¤")]),a._v(" "),s("ol",[s("li",[a._v("ä½¿ç”¨ "),s("code",[a._v("jmap")]),a._v(" æˆ– "),s("code",[a._v("-XX:+HeapDumpOnOutOfMemoryError")]),a._v(" è·å–å †å¿«ç…§ã€‚")]),a._v(" "),s("li",[a._v("ä½¿ç”¨å†…å­˜åˆ†æå·¥å…·ï¼ˆvisualvmã€matã€jProfile ç­‰ï¼‰å¯¹å †å¿«ç…§æ–‡ä»¶è¿›è¡Œåˆ†æã€‚")]),a._v(" "),s("li",[a._v("æ ¹æ®åˆ†æå›¾ï¼Œé‡ç‚¹æ˜¯ç¡®è®¤å†…å­˜ä¸­çš„å¯¹è±¡æ˜¯å¦æ˜¯å¿…è¦çš„ï¼Œåˆ†æ¸…ç©¶ç«Ÿæ˜¯æ˜¯å†…å­˜æ³„æ¼ï¼ˆMemory Leakï¼‰è¿˜æ˜¯å†…å­˜æº¢å‡ºï¼ˆMemory Overflowï¼‰ã€‚")])]),a._v(" "),s("h4",{attrs:{id:"å†…å­˜æ³„æ¼"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å†…å­˜æ³„æ¼"}},[a._v("#")]),a._v(" å†…å­˜æ³„æ¼")]),a._v(" "),s("p",[s("strong",[a._v("å†…å­˜æ³„æ¼æ˜¯æŒ‡ç”±äºç–å¿½æˆ–é”™è¯¯é€ æˆç¨‹åºæœªèƒ½é‡Šæ”¾å·²ç»ä¸å†ä½¿ç”¨çš„å†…å­˜çš„æƒ…å†µ")]),a._v("ã€‚")]),a._v(" "),s("p",[a._v("å†…å­˜æ³„æ¼å¹¶éæŒ‡å†…å­˜åœ¨ç‰©ç†ä¸Šçš„æ¶ˆå¤±ï¼Œè€Œæ˜¯åº”ç”¨ç¨‹åºåˆ†é…æŸæ®µå†…å­˜åï¼Œç”±äºè®¾è®¡é”™è¯¯ï¼Œå¤±å»äº†å¯¹è¯¥æ®µå†…å­˜çš„æ§åˆ¶ï¼Œå› è€Œé€ æˆäº†å†…å­˜çš„æµªè´¹ã€‚å†…å­˜æ³„æ¼éšç€è¢«æ‰§è¡Œçš„æ¬¡æ•°ä¸æ–­å¢åŠ ï¼Œæœ€ç»ˆä¼šå¯¼è‡´å†…å­˜æº¢å‡ºã€‚")]),a._v(" "),s("p",[a._v("å†…å­˜æ³„æ¼å¸¸è§åœºæ™¯ï¼š")]),a._v(" "),s("ul",[s("li",[a._v("é™æ€å®¹å™¨\n"),s("ul",[s("li",[a._v("å£°æ˜ä¸ºé™æ€ï¼ˆ"),s("code",[a._v("static")]),a._v("ï¼‰çš„ "),s("code",[a._v("HashMap")]),a._v("ã€"),s("code",[a._v("Vector")]),a._v(" ç­‰é›†åˆ")]),a._v(" "),s("li",[a._v("é€šä¿—æ¥è®² A ä¸­æœ‰ Bï¼Œå½“å‰åªæŠŠ B è®¾ç½®ä¸ºç©ºï¼ŒA æ²¡æœ‰è®¾ç½®ä¸ºç©ºï¼Œå›æ”¶æ—¶ B æ— æ³•å›æ”¶ã€‚å› ä¸ºè¢« A å¼•ç”¨ã€‚")])])]),a._v(" "),s("li",[a._v("ç›‘å¬å™¨\n"),s("ul",[s("li",[a._v("ç›‘å¬å™¨è¢«æ³¨å†Œåé‡Šæ”¾å¯¹è±¡æ—¶æ²¡æœ‰åˆ é™¤ç›‘å¬å™¨")])])]),a._v(" "),s("li",[a._v("ç‰©ç†è¿æ¥\n"),s("ul",[s("li",[a._v("å„ç§è¿æ¥æ± å»ºç«‹äº†è¿æ¥ï¼Œå¿…é¡»é€šè¿‡ "),s("code",[a._v("close()")]),a._v(" å…³é—­é“¾æ¥")])])]),a._v(" "),s("li",[a._v("å†…éƒ¨ç±»å’Œå¤–éƒ¨æ¨¡å—ç­‰çš„å¼•ç”¨\n"),s("ul",[s("li",[a._v("å‘ç°å®ƒçš„æ–¹å¼åŒå†…å­˜æº¢å‡ºï¼Œå¯å†åŠ ä¸ªå®æ—¶è§‚å¯Ÿ")]),a._v(" "),s("li",[s("code",[a._v("jstat -gcutil 7362 2500 70")])])])])]),a._v(" "),s("p",[a._v("é‡ç‚¹å…³æ³¨ï¼š")]),a._v(" "),s("ul",[s("li",[s("code",[a._v("FGC")]),a._v(" â€” ä»åº”ç”¨ç¨‹åºå¯åŠ¨åˆ°é‡‡æ ·æ—¶å‘ç”Ÿ Full GC çš„æ¬¡æ•°ã€‚")]),a._v(" "),s("li",[s("code",[a._v("FGCT")]),a._v(" â€” ä»åº”ç”¨ç¨‹åºå¯åŠ¨åˆ°é‡‡æ ·æ—¶ Full GC æ‰€ç”¨çš„æ—¶é—´ï¼ˆå•ä½ç§’ï¼‰ã€‚")]),a._v(" "),s("li",[s("code",[a._v("FGC")]),a._v(" æ¬¡æ•°è¶Šå¤šï¼Œ"),s("code",[a._v("FGCT")]),a._v(" æ‰€éœ€æ—¶é—´è¶Šå¤šï¼Œè¶Šæœ‰å¯èƒ½å­˜åœ¨å†…å­˜æ³„æ¼ã€‚")])]),a._v(" "),s("p",[a._v("å¦‚æœæ˜¯å†…å­˜æ³„æ¼ï¼Œå¯ä»¥è¿›ä¸€æ­¥æŸ¥çœ‹æ³„æ¼å¯¹è±¡åˆ° GC Roots çš„å¯¹è±¡å¼•ç”¨é“¾ã€‚è¿™æ ·å°±èƒ½æ‰¾åˆ°æ³„æ¼å¯¹è±¡æ˜¯æ€æ ·ä¸ GC Roots å…³è”å¹¶å¯¼è‡´ GC æ— æ³•å›æ”¶å®ƒä»¬çš„ã€‚æŒæ¡äº†è¿™äº›åŸå› ï¼Œå°±å¯ä»¥è¾ƒå‡†ç¡®çš„å®šä½å‡ºå¼•èµ·å†…å­˜æ³„æ¼çš„ä»£ç ã€‚")]),a._v(" "),s("p",[a._v("å¯¼è‡´å†…å­˜æ³„æ¼çš„å¸¸è§åŸå› æ˜¯ä½¿ç”¨å®¹å™¨ï¼Œä¸”ä¸æ–­å‘å®¹å™¨ä¸­æ·»åŠ å…ƒç´ ï¼Œä½†æ²¡æœ‰æ¸…ç†ï¼Œå¯¼è‡´å®¹å™¨å†…å­˜ä¸æ–­è†¨èƒ€ã€‚")]),a._v(" "),s("p",[a._v("ã€ç¤ºä¾‹ã€‘")]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n * å†…å­˜æ³„æ¼ç¤ºä¾‹\n * é”™è¯¯ç°è±¡ï¼šjava.lang.OutOfMemoryError: Java heap space\n * VM Argsï¼š-verbose:gc -Xms10M -Xmx10M -XX:+HeapDumpOnOutOfMemoryError\n */")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("HeapOutOfMemoryDemo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("List")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("OomObject")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v(" list "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ArrayList")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("while")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            list"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("OomObject")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("OomObject")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),s("h4",{attrs:{id:"å†…å­˜æº¢å‡º"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å†…å­˜æº¢å‡º"}},[a._v("#")]),a._v(" å†…å­˜æº¢å‡º")]),a._v(" "),s("p",[a._v("å¦‚æœä¸å­˜åœ¨å†…å­˜æ³„æ¼ï¼Œå³å†…å­˜ä¸­çš„å¯¹è±¡ç¡®å®éƒ½å¿…é¡»å­˜æ´»ç€ï¼Œåˆ™åº”å½“æ£€æŸ¥è™šæ‹Ÿæœºçš„å †å‚æ•°ï¼ˆ"),s("code",[a._v("-Xmx")]),a._v(" å’Œ "),s("code",[a._v("-Xms")]),a._v("ï¼‰ï¼Œä¸æœºå™¨ç‰©ç†å†…å­˜è¿›è¡Œå¯¹æ¯”ï¼Œçœ‹çœ‹æ˜¯å¦å¯ä»¥è°ƒå¤§ã€‚å¹¶ä»ä»£ç ä¸Šæ£€æŸ¥æ˜¯å¦å­˜åœ¨æŸäº›å¯¹è±¡ç”Ÿå‘½å‘¨æœŸè¿‡é•¿ã€æŒæœ‰æ—¶é—´è¿‡é•¿çš„æƒ…å†µï¼Œå°è¯•å‡å°‘ç¨‹åºè¿è¡ŒæœŸçš„å†…å­˜æ¶ˆè€—ã€‚")]),a._v(" "),s("p",[a._v("ã€ç¤ºä¾‹ã€‘")]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v('/**\n * å †æº¢å‡ºç¤ºä¾‹\n * <p>\n * é”™è¯¯ç°è±¡ï¼šjava.lang.OutOfMemoryError: Java heap space\n * <p>\n * VM Argsï¼š-verbose:gc -Xms10M -Xmx10M\n *\n * @author <a href="mailto:forbreak@163.com">Zhang Peng</a>\n * @since 2019-06-25\n */')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("HeapOutOfMemoryDemo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Double")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" array "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Double")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("999999999")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"array length = ["')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" array"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("length "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"]"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),s("p",[a._v("æ‰§è¡Œ "),s("code",[a._v("java -verbose:gc -Xms10M -Xmx10M -XX:+HeapDumpOnOutOfMemoryError io.github.dunwu.javacore.jvm.memory.HeapMemoryLeakMemoryErrorDemo")])]),a._v(" "),s("p",[a._v("ä¸Šé¢çš„ä¾‹å­æ˜¯ä¸€ä¸ªæç«¯çš„ä¾‹å­ï¼Œè¯•å›¾åˆ›å»ºä¸€ä¸ªç»´åº¦å¾ˆå¤§çš„æ•°ç»„ï¼Œå †å†…å­˜æ— æ³•åˆ†é…è¿™ä¹ˆå¤§çš„å†…å­˜ï¼Œä»è€ŒæŠ¥é”™ï¼š"),s("code",[a._v("Java heap space")]),a._v("ã€‚")]),a._v(" "),s("p",[a._v("ä½†å¦‚æœåœ¨ç°å®ä¸­ï¼Œä»£ç å¹¶æ²¡æœ‰é—®é¢˜ï¼Œä»…ä»…æ˜¯å› ä¸ºå †å†…å­˜ä¸è¶³ï¼Œå¯ä»¥é€šè¿‡ "),s("code",[a._v("-Xms")]),a._v(" å’Œ "),s("code",[a._v("-Xmx")]),a._v(" é€‚å½“è°ƒæ•´å †å†…å­˜å¤§å°ã€‚")]),a._v(" "),s("h3",{attrs:{id:"gc-overhead-limit-exceeded"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#gc-overhead-limit-exceeded"}},[a._v("#")]),a._v(" GC overhead limit exceeded")]),a._v(" "),s("p",[s("code",[a._v("java.lang.OutOfMemoryError: GC overhead limit exceeded")]),a._v(" è¿™ä¸ªé”™è¯¯ï¼Œå®˜æ–¹ç»™å‡ºçš„å®šä¹‰æ˜¯ï¼š"),s("strong",[a._v("è¶…è¿‡ "),s("code",[a._v("98%")]),a._v(" çš„æ—¶é—´ç”¨æ¥åš GC å¹¶ä¸”å›æ”¶äº†ä¸åˆ° "),s("code",[a._v("2%")]),a._v(" çš„å †å†…å­˜æ—¶ä¼šæŠ›å‡ºæ­¤å¼‚å¸¸")]),a._v("ã€‚è¿™æ„å‘³ç€ï¼Œå‘ç”Ÿåœ¨ GC å ç”¨å¤§é‡æ—¶é—´ä¸ºé‡Šæ”¾å¾ˆå°ç©ºé—´çš„æ—¶å€™å‘ç”Ÿçš„ï¼Œæ˜¯ä¸€ç§ä¿æŠ¤æœºåˆ¶ã€‚å¯¼è‡´å¼‚å¸¸çš„åŸå› ï¼šä¸€èˆ¬æ˜¯å› ä¸ºå †å¤ªå°ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜ã€‚")]),a._v(" "),s("p",[a._v("ã€ç¤ºä¾‹ã€‘")]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n * GC overhead limit exceeded ç¤ºä¾‹\n * é”™è¯¯ç°è±¡ï¼šjava.lang.OutOfMemoryError: GC overhead limit exceeded\n * å‘ç”Ÿåœ¨GCå ç”¨å¤§é‡æ—¶é—´ä¸ºé‡Šæ”¾å¾ˆå°ç©ºé—´çš„æ—¶å€™å‘ç”Ÿçš„ï¼Œæ˜¯ä¸€ç§ä¿æŠ¤æœºåˆ¶ã€‚å¯¼è‡´å¼‚å¸¸çš„åŸå› ï¼šä¸€èˆ¬æ˜¯å› ä¸ºå †å¤ªå°ï¼Œæ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜ã€‚\n * å®˜æ–¹å¯¹æ­¤çš„å®šä¹‰ï¼šè¶…è¿‡98%çš„æ—¶é—´ç”¨æ¥åšGCå¹¶ä¸”å›æ”¶äº†ä¸åˆ°2%çš„å †å†…å­˜æ—¶ä¼šæŠ›å‡ºæ­¤å¼‚å¸¸ã€‚\n * VM Args: -Xms10M -Xmx10M\n */")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("GcOverheadLimitExceededDemo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("List")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Double")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v(" list "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ArrayList")]),s("span",{pre:!0,attrs:{class:"token generics"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("double")]),a._v(" d "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("while")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            list"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("add")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("d"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),s("p",[a._v("ã€å¤„ç†ã€‘")]),a._v(" "),s("p",[a._v("ä¸ "),s("strong",[a._v("Java heap space")]),a._v(" é”™è¯¯å¤„ç†æ–¹æ³•ç±»ä¼¼ï¼Œå…ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨å†…å­˜æ³„æ¼ã€‚å¦‚æœæœ‰ï¼Œåˆ™ä¿®æ­£ä»£ç ï¼›å¦‚æœæ²¡æœ‰ï¼Œåˆ™é€šè¿‡ "),s("code",[a._v("-Xms")]),a._v(" å’Œ "),s("code",[a._v("-Xmx")]),a._v(" é€‚å½“è°ƒæ•´å †å†…å­˜å¤§å°ã€‚")]),a._v(" "),s("h3",{attrs:{id:"permgen-space"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#permgen-space"}},[a._v("#")]),a._v(" PermGen space")]),a._v(" "),s("p",[a._v("ã€é”™è¯¯ã€‘")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("java.lang.OutOfMemoryError: PermGen space\n")])])]),s("p",[a._v("ã€åŸå› ã€‘")]),a._v(" "),s("p",[a._v("Perm ï¼ˆæ°¸ä¹…ä»£ï¼‰ç©ºé—´ä¸»è¦ç”¨äºå­˜æ”¾ Class å’Œ Meta ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç±»çš„åç§°å’Œå­—æ®µï¼Œå¸¦æœ‰æ–¹æ³•å­—èŠ‚ç çš„æ–¹æ³•ï¼Œå¸¸é‡æ± ä¿¡æ¯ï¼Œä¸ç±»å…³è”çš„å¯¹è±¡æ•°ç»„å’Œç±»å‹æ•°ç»„ä»¥åŠå³æ—¶ç¼–è¯‘å™¨ä¼˜åŒ–ã€‚GC åœ¨ä¸»ç¨‹åºè¿è¡ŒæœŸé—´ä¸ä¼šå¯¹æ°¸ä¹…ä»£ç©ºé—´è¿›è¡Œæ¸…ç†ï¼Œé»˜è®¤æ˜¯ 64M å¤§å°ã€‚")]),a._v(" "),s("p",[a._v("æ ¹æ®ä¸Šé¢çš„å®šä¹‰ï¼Œå¯ä»¥å¾—å‡º PermGen å¤§å°è¦æ±‚å–å†³äºåŠ è½½çš„ç±»çš„æ•°é‡ä»¥åŠæ­¤ç±»å£°æ˜çš„å¤§å°ã€‚å› æ­¤ï¼Œå¯ä»¥è¯´é€ æˆè¯¥é”™è¯¯çš„ä¸»è¦åŸå› æ˜¯æ°¸ä¹…ä»£ä¸­è£…å…¥äº†å¤ªå¤šçš„ç±»æˆ–å¤ªå¤§çš„ç±»ã€‚")]),a._v(" "),s("p",[a._v("åœ¨ JDK8 ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ï¼Œå¯ä»¥é€šè¿‡ "),s("code",[a._v("-XX:PermSize")]),a._v(" å’Œ "),s("code",[a._v("-XX:MaxPermSize")]),a._v(" è®¾ç½®æ°¸ä¹…ä»£ç©ºé—´å¤§å°ï¼Œä»è€Œé™åˆ¶æ–¹æ³•åŒºå¤§å°ï¼Œå¹¶é—´æ¥é™åˆ¶å…¶ä¸­å¸¸é‡æ± çš„å®¹é‡ã€‚")]),a._v(" "),s("h4",{attrs:{id:"åˆå§‹åŒ–æ—¶æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åˆå§‹åŒ–æ—¶æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³"}},[a._v("#")]),a._v(" åˆå§‹åŒ–æ—¶æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³")]),a._v(" "),s("p",[a._v("ã€ç¤ºä¾‹ã€‘")]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n * æ°¸ä¹…ä»£å†…å­˜ç©ºé—´ä¸è¶³ç¤ºä¾‹\n * <p>\n * é”™è¯¯ç°è±¡ï¼š\n * <ul>\n * <li>java.lang.OutOfMemoryError: PermGen space (JDK8 ä»¥å‰ç‰ˆæœ¬)</li>\n * <li>java.lang.OutOfMemoryError: Metaspace (JDK8 åŠä»¥åç‰ˆæœ¬)</li>\n * </ul>\n * VM Args:\n * <ul>\n * <li>-Xmx100M -XX:MaxPermSize=16M (JDK8 ä»¥å‰ç‰ˆæœ¬)</li>\n * <li>-Xmx100M -XX:MaxMetaspaceSize=16M (JDK8 åŠä»¥åç‰ˆæœ¬)</li>\n * </ul>\n */")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("PermOutOfMemoryErrorDemo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("throws")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Exception")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" i "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("100_000_000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v(" i"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("generate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"eu.plumbr.demo.Generated"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" i"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Class")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("generate")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("throws")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Exception")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ClassPool")]),a._v(" pool "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("ClassPool")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("getDefault")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" pool"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("makeClass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("toClass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),s("p",[a._v("åœ¨æ­¤ç¤ºä¾‹ä¸­ï¼Œæºä»£ç éå†å¾ªç¯å¹¶åœ¨è¿è¡Œæ—¶ç”Ÿæˆç±»ã€‚javassist åº“æ­£åœ¨å¤„ç†ç±»ç”Ÿæˆçš„å¤æ‚æ€§ã€‚")]),a._v(" "),s("h4",{attrs:{id:"é‡éƒ¨ç½²æ—¶æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#é‡éƒ¨ç½²æ—¶æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³"}},[a._v("#")]),a._v(" é‡éƒ¨ç½²æ—¶æ°¸ä¹…ä»£ç©ºé—´ä¸è¶³")]),a._v(" "),s("p",[a._v("å¯¹äºæ›´å¤æ‚ï¼Œæ›´å®é™…çš„ç¤ºä¾‹ï¼Œè®©æˆ‘ä»¬é€æ­¥ä»‹ç»ä¸€ä¸‹åœ¨åº”ç”¨ç¨‹åºé‡æ–°éƒ¨ç½²æœŸé—´å‘ç”Ÿçš„ Permgen ç©ºé—´é”™è¯¯ã€‚é‡æ–°éƒ¨ç½²åº”ç”¨ç¨‹åºæ—¶ï¼Œä½ å¸Œæœ›åƒåœ¾å›æ”¶ä¼šæ‘†è„±å¼•ç”¨æ‰€æœ‰å…ˆå‰åŠ è½½çš„ç±»çš„åŠ è½½å™¨ï¼Œå¹¶è¢«åŠ è½½æ–°ç±»çš„ç±»åŠ è½½å™¨å–ä»£ã€‚")]),a._v(" "),s("p",[a._v("ä¸å¹¸çš„æ˜¯ï¼Œè®¸å¤šç¬¬ä¸‰æ–¹åº“ä»¥åŠå¯¹çº¿ç¨‹ï¼ŒJDBC é©±åŠ¨ç¨‹åºæˆ–æ–‡ä»¶ç³»ç»Ÿå¥æŸ„ç­‰èµ„æºçš„ä¸è‰¯å¤„ç†ä½¿å¾—æ— æ³•å¸è½½ä»¥å‰ä½¿ç”¨çš„ç±»åŠ è½½å™¨ã€‚åè¿‡æ¥ï¼Œè¿™æ„å‘³ç€åœ¨æ¯æ¬¡é‡æ–°éƒ¨ç½²æœŸé—´ï¼Œæ‰€æœ‰å…ˆå‰ç‰ˆæœ¬çš„ç±»ä»å°†é©»ç•™åœ¨ PermGen ä¸­ï¼Œä»è€Œåœ¨æ¯æ¬¡é‡æ–°éƒ¨ç½²æœŸé—´ç”Ÿæˆæ•°åå…†çš„åƒåœ¾ã€‚")]),a._v(" "),s("p",[a._v("è®©æˆ‘ä»¬æƒ³è±¡ä¸€ä¸ªä½¿ç”¨ JDBC é©±åŠ¨ç¨‹åºè¿æ¥åˆ°å…³ç³»æ•°æ®åº“çš„ç¤ºä¾‹åº”ç”¨ç¨‹åºã€‚å¯åŠ¨åº”ç”¨ç¨‹åºæ—¶ï¼Œåˆå§‹åŒ–ä»£ç å°†åŠ è½½ JDBC é©±åŠ¨ç¨‹åºä»¥è¿æ¥åˆ°æ•°æ®åº“ã€‚å¯¹åº”äºè§„èŒƒï¼ŒJDBC é©±åŠ¨ç¨‹åºå‘ java.sql.DriverManager è¿›è¡Œæ³¨å†Œã€‚è¯¥æ³¨å†ŒåŒ…æ‹¬å°†å¯¹é©±åŠ¨ç¨‹åºå®ä¾‹çš„å¼•ç”¨å­˜å‚¨åœ¨ DriverManager çš„é™æ€å­—æ®µä¸­ã€‚")]),a._v(" "),s("p",[a._v("ç°åœ¨ï¼Œå½“ä»åº”ç”¨ç¨‹åºæœåŠ¡å™¨å–æ¶ˆéƒ¨ç½²åº”ç”¨ç¨‹åºæ—¶ï¼Œjava.sql.DriverManager ä»å°†ä¿ç•™è¯¥å¼•ç”¨ã€‚æˆ‘ä»¬æœ€ç»ˆè·å¾—äº†å¯¹é©±åŠ¨ç¨‹åºç±»çš„å®æ—¶å¼•ç”¨ï¼Œè€Œé©±åŠ¨ç¨‹åºç±»åˆä¿ç•™äº†ç”¨äºåŠ è½½åº”ç”¨ç¨‹åºçš„ java.lang.Classloader å®ä¾‹çš„å¼•ç”¨ã€‚åè¿‡æ¥ï¼Œè¿™æ„å‘³ç€åƒåœ¾å›æ”¶ç®—æ³•æ— æ³•å›æ”¶ç©ºé—´ã€‚")]),a._v(" "),s("p",[a._v("è€Œä¸”è¯¥ java.lang.ClassLoader å®ä¾‹ä»å¼•ç”¨åº”ç”¨ç¨‹åºçš„æ‰€æœ‰ç±»ï¼Œé€šå¸¸åœ¨ PermGen ä¸­å æ®æ•°åå…†å­—èŠ‚ã€‚è¿™æ„å‘³ç€åªéœ€å°‘é‡é‡æ–°éƒ¨ç½²å³å¯å¡«å……é€šå¸¸å¤§å°çš„ PermGenã€‚")]),a._v(" "),s("h4",{attrs:{id:"permgen-space-è§£å†³æ–¹æ¡ˆ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#permgen-space-è§£å†³æ–¹æ¡ˆ"}},[a._v("#")]),a._v(" Permgen space è§£å†³æ–¹æ¡ˆ")]),a._v(" "),s("p",[a._v("ï¼ˆ1ï¼‰è§£å†³åˆå§‹åŒ–æ—¶çš„ OutOfMemoryError")]),a._v(" "),s("p",[a._v("åœ¨åº”ç”¨ç¨‹åºå¯åŠ¨æœŸé—´è§¦å‘ç”±äº PermGen è€—å°½å¯¼è‡´çš„ "),s("code",[a._v("OutOfMemoryError")]),a._v(" æ—¶ï¼Œè§£å†³æ–¹æ¡ˆå¾ˆç®€å•ã€‚è¯¥åº”ç”¨ç¨‹åºä»…éœ€è¦æ›´å¤šç©ºé—´æ‰èƒ½å°†æ‰€æœ‰ç±»åŠ è½½åˆ° PermGen åŒºåŸŸï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦å¢åŠ å…¶å¤§å°å³å¯ã€‚ä¸ºæ­¤ï¼Œæ›´æ”¹ä½ çš„åº”ç”¨ç¨‹åºå¯åŠ¨é…ç½®å¹¶æ·»åŠ ï¼ˆæˆ–å¢åŠ ï¼Œå¦‚æœå­˜åœ¨ï¼‰"),s("code",[a._v("-XX:MaxPermSize")]),a._v(" å‚æ•°ï¼Œç±»ä¼¼äºä»¥ä¸‹ç¤ºä¾‹ï¼š")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("java -XX:MaxPermSize=512m com.yourcompany.YourClass\n")])])]),s("p",[a._v("ä¸Šé¢çš„é…ç½®å°†å‘Šè¯‰ JVMï¼ŒPermGen å¯ä»¥å¢é•¿åˆ° 512MBã€‚")]),a._v(" "),s("p",[a._v("æ¸…ç†åº”ç”¨ç¨‹åºä¸­ "),s("code",[a._v("WEB-INF/lib")]),a._v(" ä¸‹çš„ jarï¼Œç”¨ä¸ä¸Šçš„ jar åˆ é™¤æ‰ï¼Œå¤šä¸ªåº”ç”¨å…¬å…±çš„ jar ç§»åŠ¨åˆ° Tomcat çš„ lib ç›®å½•ï¼Œå‡å°‘é‡å¤åŠ è½½ã€‚")]),a._v(" "),s("p",[a._v("ğŸ”” æ³¨æ„ï¼š"),s("code",[a._v("-XX:PermSize")]),a._v(" ä¸€èˆ¬è®¾ä¸º 64M")]),a._v(" "),s("p",[a._v("ï¼ˆ2ï¼‰è§£å†³é‡æ–°éƒ¨ç½²æ—¶çš„ OutOfMemoryError")]),a._v(" "),s("p",[a._v("é‡æ–°éƒ¨ç½²åº”ç”¨ç¨‹åºåç«‹å³å‘ç”Ÿ OutOfMemoryError æ—¶ï¼Œåº”ç”¨ç¨‹åºä¼šé­å—ç±»åŠ è½½å™¨æ³„æ¼çš„å›°æ‰°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè§£å†³é—®é¢˜çš„æœ€ç®€å•ï¼Œç»§ç»­è¿›è¡Œå †è½¬å‚¨åˆ†æâ€“ä½¿ç”¨ç±»ä¼¼äºä»¥ä¸‹å‘½ä»¤çš„é‡æ–°éƒ¨ç½²åè¿›è¡Œå †è½¬å‚¨ï¼š")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("jmap -dump:format=b,file=dump.hprof <process-id>\n")])])]),s("p",[a._v("ç„¶åä½¿ç”¨ä½ æœ€å–œæ¬¢çš„å †è½¬å‚¨åˆ†æå™¨æ‰“å¼€è½¬å‚¨ï¼ˆEclipse MAT æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å·¥å…·ï¼‰ã€‚åœ¨åˆ†æå™¨ä¸­å¯ä»¥æŸ¥æ‰¾é‡å¤çš„ç±»ï¼Œå°¤å…¶æ˜¯é‚£äº›æ­£åœ¨åŠ è½½åº”ç”¨ç¨‹åºç±»çš„ç±»ã€‚ä»é‚£é‡Œï¼Œä½ éœ€è¦è¿›è¡Œæ‰€æœ‰ç±»åŠ è½½å™¨çš„æŸ¥æ‰¾ï¼Œä»¥æ‰¾åˆ°å½“å‰æ´»åŠ¨çš„ç±»åŠ è½½å™¨ã€‚")]),a._v(" "),s("p",[a._v("å¯¹äºéæ´»åŠ¨ç±»åŠ è½½å™¨ï¼Œä½ éœ€è¦é€šè¿‡ä»éæ´»åŠ¨ç±»åŠ è½½å™¨æ”¶é›†åˆ° GC æ ¹çš„æœ€çŸ­è·¯å¾„æ¥ç¡®å®šé˜»æ­¢å®ƒä»¬è¢«åƒåœ¾æ”¶é›†çš„å¼•ç”¨ã€‚æœ‰äº†æ­¤ä¿¡æ¯ï¼Œä½ å°†æ‰¾åˆ°æ ¹æœ¬åŸå› ã€‚å¦‚æœæ ¹æœ¬åŸå› æ˜¯åœ¨ç¬¬ä¸‰æ–¹åº“ä¸­ï¼Œåˆ™å¯ä»¥è¿›å…¥ Google/StackOverflow æŸ¥çœ‹æ˜¯å¦æ˜¯å·²çŸ¥é—®é¢˜ä»¥è·å–è¡¥ä¸/è§£å†³æ–¹æ³•ã€‚")]),a._v(" "),s("p",[a._v("ï¼ˆ3ï¼‰è§£å†³è¿è¡Œæ—¶ OutOfMemoryError")]),a._v(" "),s("p",[a._v("ç¬¬ä¸€æ­¥æ˜¯æ£€æŸ¥æ˜¯å¦å…è®¸ GC ä» PermGen å¸è½½ç±»ã€‚åœ¨è¿™æ–¹é¢ï¼Œæ ‡å‡†çš„ JVM ç›¸å½“ä¿å®ˆ-ç±»æ˜¯å¤©ç”Ÿçš„ã€‚å› æ­¤ï¼Œä¸€æ—¦åŠ è½½ï¼Œå³ä½¿æ²¡æœ‰ä»£ç åœ¨ä½¿ç”¨å®ƒä»¬ï¼Œç±»ä¹Ÿä¼šä¿ç•™åœ¨å†…å­˜ä¸­ã€‚å½“åº”ç”¨ç¨‹åºåŠ¨æ€åˆ›å»ºè®¸å¤šç±»å¹¶ä¸”é•¿æ—¶é—´ä¸éœ€è¦ç”Ÿæˆçš„ç±»æ—¶ï¼Œè¿™å¯èƒ½ä¼šæˆä¸ºé—®é¢˜ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå…è®¸ JVM å¸è½½ç±»å®šä¹‰å¯èƒ½ä¼šæœ‰æ‰€å¸®åŠ©ã€‚è¿™å¯ä»¥é€šè¿‡åœ¨å¯åŠ¨è„šæœ¬ä¸­ä»…æ·»åŠ ä¸€ä¸ªé…ç½®å‚æ•°æ¥å®ç°ï¼š")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("-XX:+CMSClassUnloadingEnabled\n")])])]),s("p",[a._v("é»˜è®¤æƒ…å†µä¸‹ï¼Œæ­¤é€‰é¡¹è®¾ç½®ä¸º falseï¼Œå› æ­¤è¦å¯ç”¨æ­¤åŠŸèƒ½ï¼Œä½ éœ€è¦åœ¨ Java é€‰é¡¹ä¸­æ˜¾å¼è®¾ç½®ã€‚å¦‚æœå¯ç”¨ CMSClassUnloadingEnabledï¼ŒGC ä¹Ÿä¼šæ‰«æ PermGen å¹¶åˆ é™¤ä¸å†ä½¿ç”¨çš„ç±»ã€‚è¯·è®°ä½ï¼Œåªæœ‰åŒæ—¶ä½¿ç”¨ UseConcMarkSweepGC æ—¶æ­¤é€‰é¡¹æ‰èµ·ä½œç”¨ã€‚")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("-XX:+UseConcMarkSweepGC\n")])])]),s("p",[a._v("åœ¨ç¡®ä¿å¯ä»¥å¸è½½ç±»å¹¶ä¸”é—®é¢˜ä»ç„¶å­˜åœ¨ä¹‹åï¼Œä½ åº”è¯¥ç»§ç»­è¿›è¡Œå †è½¬å‚¨åˆ†æâ€“ä½¿ç”¨ç±»ä¼¼äºä»¥ä¸‹å‘½ä»¤çš„æ–¹æ³•è¿›è¡Œå †è½¬å‚¨ï¼š")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("jmap -dump:file=dump.hprof,format=b <process-id>\n")])])]),s("p",[a._v("ç„¶åï¼Œä½¿ç”¨ä½ æœ€å–œæ¬¢çš„å †è½¬å‚¨åˆ†æå™¨ï¼ˆä¾‹å¦‚ Eclipse MATï¼‰æ‰“å¼€è½¬å‚¨ï¼Œç„¶åæ ¹æ®å·²åŠ è½½çš„ç±»æ•°æŸ¥æ‰¾æœ€æ˜‚è´µçš„ç±»åŠ è½½å™¨ã€‚ä»æ­¤ç±»åŠ è½½å™¨ä¸­ï¼Œä½ å¯ä»¥ç»§ç»­æå–å·²åŠ è½½çš„ç±»ï¼Œå¹¶æŒ‰å®ä¾‹å¯¹æ­¤ç±»è¿›è¡Œæ’åºï¼Œä»¥ä½¿å¯ç–‘å¯¹è±¡æ’åœ¨é¦–ä½ã€‚")]),a._v(" "),s("p",[a._v("ç„¶åï¼Œå¯¹äºæ¯ä¸ªå¯ç–‘è€…ï¼Œå°±éœ€è¦ä½ æ‰‹åŠ¨å°†æ ¹æœ¬åŸå› è¿½æº¯åˆ°ç”Ÿæˆæ­¤ç±»çš„åº”ç”¨ç¨‹åºä»£ç ã€‚")]),a._v(" "),s("h3",{attrs:{id:"metaspace"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#metaspace"}},[a._v("#")]),a._v(" Metaspace")]),a._v(" "),s("p",[a._v("ã€é”™è¯¯ã€‘")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('Exception in thread "main" java.lang.OutOfMemoryError: Metaspace\n')])])]),s("p",[a._v("ã€åŸå› ã€‘"),s("strong",[a._v("å…ƒæ•°æ®åŒºçš„å†…å­˜ä¸è¶³ï¼Œå³æ–¹æ³•åŒºå’Œè¿è¡Œæ—¶å¸¸é‡æ± çš„ç©ºé—´ä¸è¶³")]),a._v("ã€‚")]),a._v(" "),s("p",[a._v("æ–¹æ³•åŒºç”¨äºå­˜æ”¾ Class çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚ç±»åã€è®¿é—®ä¿®é¥°ç¬¦ã€å¸¸é‡æ± ã€å­—æ®µæè¿°ã€æ–¹æ³•æè¿°ç­‰ã€‚")]),a._v(" "),s("p",[a._v("ä¸€ä¸ªç±»è¦è¢«åƒåœ¾æ”¶é›†å™¨å›æ”¶ï¼Œåˆ¤å®šæ¡ä»¶æ˜¯æ¯”è¾ƒè‹›åˆ»çš„ã€‚åœ¨ç»å¸¸åŠ¨æ€ç”Ÿæˆå¤§é‡ Class çš„åº”ç”¨ä¸­ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„ç±»çš„å›æ”¶çŠ¶å†µã€‚è¿™ç±»å¸¸è§é™¤äº† CGLib å­—èŠ‚ç å¢å¼ºå’ŒåŠ¨æ€è¯­è¨€ä»¥å¤–ï¼Œå¸¸è§çš„è¿˜æœ‰ï¼šå¤§é‡ JSP æˆ–åŠ¨æ€äº§ç”Ÿ JSP æ–‡ä»¶çš„åº”ç”¨ï¼ˆJSP ç¬¬ä¸€æ¬¡è¿è¡Œæ—¶éœ€è¦ç¼–è¯‘ä¸º Java ç±»ï¼‰ã€åŸºäº OSGi çš„åº”ç”¨ï¼ˆå³ä½¿æ˜¯åŒä¸€ä¸ªç±»æ–‡ä»¶ï¼Œè¢«ä¸åŒçš„åŠ è½½å™¨åŠ è½½ä¹Ÿä¼šè§†ä¸ºä¸åŒçš„ç±»ï¼‰ç­‰ã€‚")]),a._v(" "),s("p",[a._v("ã€ç¤ºä¾‹ã€‘æ–¹æ³•åŒºå‡ºç° "),s("code",[a._v("OutOfMemoryError")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("MethodAreaOutOfMemoryDemo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("while")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Enhancer")]),a._v(" enhancer "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Enhancer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n            enhancer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("setSuperclass")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Bean")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n            enhancer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("setUseCache")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n            enhancer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("setCallback")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("MethodInterceptor")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n                "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Override")]),a._v("\n                "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Object")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("intercept")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Object")]),a._v(" obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Method")]),a._v(" method"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Object")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("MethodProxy")]),a._v(" proxy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("throws")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Throwable")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n                    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("return")]),a._v(" proxy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("invokeSuper")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n            enhancer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("create")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Bean")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),s("p",[a._v("ã€è§£å†³ã€‘")]),a._v(" "),s("p",[a._v("å½“ç”±äºå…ƒç©ºé—´è€Œé¢ä¸´ OutOfMemoryError æ—¶ï¼Œç¬¬ä¸€ä¸ªè§£å†³æ–¹æ¡ˆåº”è¯¥æ˜¯æ˜¾è€Œæ˜“è§çš„ã€‚å¦‚æœåº”ç”¨ç¨‹åºè€—å°½äº†å†…å­˜ä¸­çš„ Metaspace åŒºåŸŸï¼Œåˆ™åº”å¢åŠ  Metaspace çš„å¤§å°ã€‚æ›´æ”¹åº”ç”¨ç¨‹åºå¯åŠ¨é…ç½®å¹¶å¢åŠ ä»¥ä¸‹å†…å®¹ï¼š")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("-XX:MaxMetaspaceSize=512m\n")])])]),s("p",[a._v("ä¸Šé¢çš„é…ç½®ç¤ºä¾‹å‘Šè¯‰ JVMï¼Œå…è®¸ Metaspace å¢é•¿åˆ° 512 MBã€‚")]),a._v(" "),s("p",[a._v("å¦ä¸€ç§è§£å†³æ–¹æ¡ˆç”šè‡³æ›´ç®€å•ã€‚ä½ å¯ä»¥é€šè¿‡åˆ é™¤æ­¤å‚æ•°æ¥å®Œå…¨è§£é™¤å¯¹ Metaspace å¤§å°çš„é™åˆ¶ï¼ŒJVM é»˜è®¤å¯¹ Metaspace çš„å¤§å°æ²¡æœ‰é™åˆ¶ã€‚ä½†æ˜¯è¯·æ³¨æ„ä»¥ä¸‹äº‹å®ï¼šè¿™æ ·åšå¯èƒ½ä¼šå¯¼è‡´å¤§é‡äº¤æ¢æˆ–è¾¾åˆ°æœ¬æœºç‰©ç†å†…å­˜è€Œåˆ†é…å¤±è´¥ã€‚")]),a._v(" "),s("h3",{attrs:{id:"unable-to-create-new-native-thread"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#unable-to-create-new-native-thread"}},[a._v("#")]),a._v(" Unable to create new native thread")]),a._v(" "),s("p",[s("code",[a._v("java.lang.OutOfMemoryError: Unable to create new native thread")]),a._v(" è¿™ä¸ªé”™è¯¯æ„å‘³ç€ï¼š"),s("strong",[a._v("Java åº”ç”¨ç¨‹åºå·²è¾¾åˆ°å…¶å¯ä»¥å¯åŠ¨çº¿ç¨‹æ•°çš„é™åˆ¶")]),a._v("ã€‚")]),a._v(" "),s("p",[a._v("ã€åŸå› ã€‘")]),a._v(" "),s("p",[a._v("å½“å‘èµ·ä¸€ä¸ªçº¿ç¨‹çš„åˆ›å»ºæ—¶ï¼Œè™šæ‹Ÿæœºä¼šåœ¨ JVM å†…å­˜åˆ›å»ºä¸€ä¸ª "),s("code",[a._v("Thread")]),a._v(" å¯¹è±¡åŒæ—¶åˆ›å»ºä¸€ä¸ªæ“ä½œç³»ç»Ÿçº¿ç¨‹ï¼Œè€Œè¿™ä¸ªç³»ç»Ÿçº¿ç¨‹çš„å†…å­˜ç”¨çš„ä¸æ˜¯ JVM å†…å­˜ï¼Œè€Œæ˜¯ç³»ç»Ÿä¸­å‰©ä¸‹çš„å†…å­˜ã€‚")]),a._v(" "),s("p",[a._v("é‚£ä¹ˆï¼Œç©¶ç«Ÿèƒ½åˆ›å»ºå¤šå°‘çº¿ç¨‹å‘¢ï¼Ÿè¿™é‡Œæœ‰ä¸€ä¸ªå…¬å¼ï¼š")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("çº¿ç¨‹æ•° = (MaxProcessMemory - JVMMemory - ReservedOsMemory) / (ThreadStackSize)\n")])])]),s("p",[a._v("ã€å‚æ•°ã€‘")]),a._v(" "),s("ul",[s("li",[s("code",[a._v("MaxProcessMemory")]),a._v(" - ä¸€ä¸ªè¿›ç¨‹çš„æœ€å¤§å†…å­˜")]),a._v(" "),s("li",[s("code",[a._v("JVMMemory")]),a._v(" - JVM å†…å­˜")]),a._v(" "),s("li",[s("code",[a._v("ReservedOsMemory")]),a._v(" - ä¿ç•™çš„æ“ä½œç³»ç»Ÿå†…å­˜")]),a._v(" "),s("li",[s("code",[a._v("ThreadStackSize")]),a._v(" - çº¿ç¨‹æ ˆçš„å¤§å°")])]),a._v(" "),s("p",[s("strong",[a._v("ç»™ JVM åˆ†é…çš„å†…å­˜è¶Šå¤šï¼Œé‚£ä¹ˆèƒ½ç”¨æ¥åˆ›å»ºç³»ç»Ÿçº¿ç¨‹çš„å†…å­˜å°±ä¼šè¶Šå°‘ï¼Œè¶Šå®¹æ˜“å‘ç”Ÿ "),s("code",[a._v("unable to create new native thread")])]),a._v("ã€‚æ‰€ä»¥ï¼ŒJVM å†…å­˜ä¸æ˜¯åˆ†é…çš„è¶Šå¤§è¶Šå¥½ã€‚")]),a._v(" "),s("p",[a._v("ä½†æ˜¯ï¼Œé€šå¸¸å¯¼è‡´ "),s("code",[a._v("java.lang.OutOfMemoryError")]),a._v(" çš„æƒ…å†µï¼šæ— æ³•åˆ›å»ºæ–°çš„æœ¬æœºçº¿ç¨‹éœ€è¦ç»å†ä»¥ä¸‹é˜¶æ®µï¼š")]),a._v(" "),s("ol",[s("li",[a._v("JVM å†…éƒ¨è¿è¡Œçš„åº”ç”¨ç¨‹åºè¯·æ±‚æ–°çš„ Java çº¿ç¨‹")]),a._v(" "),s("li",[a._v("JVM æœ¬æœºä»£ç ä»£ç†ä¸ºæ“ä½œç³»ç»Ÿåˆ›å»ºæ–°æœ¬æœºçº¿ç¨‹çš„è¯·æ±‚")]),a._v(" "),s("li",[a._v("æ“ä½œç³»ç»Ÿå°è¯•åˆ›å»ºä¸€ä¸ªæ–°çš„æœ¬æœºçº¿ç¨‹ï¼Œè¯¥çº¿ç¨‹éœ€è¦å°†å†…å­˜åˆ†é…ç»™è¯¥çº¿ç¨‹")]),a._v(" "),s("li",[a._v("æ“ä½œç³»ç»Ÿå°†æ‹’ç»æœ¬æœºå†…å­˜åˆ†é…ï¼ŒåŸå› æ˜¯ 32 ä½ Java è¿›ç¨‹å¤§å°å·²è€—å°½å…¶å†…å­˜åœ°å€ç©ºé—´ï¼ˆä¾‹å¦‚ï¼Œå·²è¾¾åˆ°ï¼ˆ2-4ï¼‰GB è¿›ç¨‹å¤§å°é™åˆ¶ï¼‰æˆ–æ“ä½œç³»ç»Ÿçš„è™šæ‹Ÿå†…å­˜å·²å®Œå…¨è€—å°½")]),a._v(" "),s("li",[a._v("å¼•å‘ "),s("code",[a._v("java.lang.OutOfMemoryError: Unable to create new native thread")]),a._v(" é”™è¯¯ã€‚")])]),a._v(" "),s("p",[a._v("ã€ç¤ºä¾‹ã€‘")]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("UnableCreateNativeThreadErrorDemo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("while")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Thread")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Runnable")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n                "),s("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Override")]),a._v("\n                "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("run")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n                    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("try")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n                        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("TimeUnit")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("MINUTES"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sleep")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n                    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("catch")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("InterruptedException")]),a._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n                        e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("printStackTrace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n                    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("start")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),s("p",[a._v("ã€å¤„ç†ã€‘")]),a._v(" "),s("p",[a._v("å¯ä»¥é€šè¿‡å¢åŠ æ“ä½œç³»ç»Ÿçº§åˆ«çš„é™åˆ¶æ¥ç»•è¿‡æ— æ³•åˆ›å»ºæ–°çš„æœ¬æœºçº¿ç¨‹é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå¦‚æœé™åˆ¶äº† JVM å¯åœ¨ç”¨æˆ·ç©ºé—´ä¸­äº§ç”Ÿçš„è¿›ç¨‹æ•°ï¼Œåˆ™åº”æ£€æŸ¥å‡ºå¹¶å¯èƒ½å¢åŠ è¯¥é™åˆ¶ï¼š")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[root@dev ~]# ulimit -a\ncore file size          (blocks, -c) 0\n--- cut for brevity ---\nmax user processes              (-u) 1800\n")])])]),s("p",[a._v("é€šå¸¸ï¼ŒOutOfMemoryError å¯¹æ–°çš„æœ¬æœºçº¿ç¨‹çš„é™åˆ¶è¡¨ç¤ºç¼–ç¨‹é”™è¯¯ã€‚å½“åº”ç”¨ç¨‹åºäº§ç”Ÿæ•°åƒä¸ªçº¿ç¨‹æ—¶ï¼Œå¾ˆå¯èƒ½å‡ºäº†ä¸€äº›é—®é¢˜â€”å¾ˆå°‘æœ‰åº”ç”¨ç¨‹åºå¯ä»¥ä»å¦‚æ­¤å¤§é‡çš„çº¿ç¨‹ä¸­å—ç›Šã€‚")]),a._v(" "),s("p",[a._v("è§£å†³é—®é¢˜çš„ä¸€ç§æ–¹æ³•æ˜¯å¼€å§‹è¿›è¡Œçº¿ç¨‹è½¬å‚¨ä»¥äº†è§£æƒ…å†µã€‚")]),a._v(" "),s("h3",{attrs:{id:"ç›´æ¥å†…å­˜æº¢å‡º"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ç›´æ¥å†…å­˜æº¢å‡º"}},[a._v("#")]),a._v(" ç›´æ¥å†…å­˜æº¢å‡º")]),a._v(" "),s("p",[a._v("ç”±ç›´æ¥å†…å­˜å¯¼è‡´çš„å†…å­˜æº¢å‡ºï¼Œä¸€ä¸ªæ˜æ˜¾çš„ç‰¹å¾æ˜¯åœ¨ Head Dump æ–‡ä»¶ä¸­ä¸ä¼šçœ‹è§æ˜æ˜¾çš„å¼‚å¸¸ï¼Œå¦‚æœå‘ç° OOM ä¹‹å Dump æ–‡ä»¶å¾ˆå°ï¼Œè€Œç¨‹åºä¸­åˆç›´æ¥æˆ–é—´æ¥ä½¿ç”¨äº† NIOï¼Œå°±å¯ä»¥è€ƒè™‘æ£€æŸ¥ä¸€ä¸‹æ˜¯ä¸æ˜¯è¿™æ–¹é¢çš„åŸå› ã€‚")]),a._v(" "),s("p",[a._v("ç¤ºä¾‹ï¼šç›´æ¥å†…å­˜ "),s("code",[a._v("OutOfMemoryError")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("/**\n * æœ¬æœºç›´æ¥å†…å­˜æº¢å‡ºç¤ºä¾‹\n * é”™è¯¯ç°è±¡ï¼šjava.lang.OutOfMemoryError\n * VM Argsï¼š-Xmx20M -XX:MaxDirectMemorySize=10M\n */")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("DirectOutOfMemoryDemo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("final")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" _1MB "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1024")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1024")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("throws")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("IllegalAccessException")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Field")]),a._v(" unsafeField "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Unsafe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("getDeclaredFields")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        unsafeField"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("setAccessible")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Unsafe")]),a._v(" unsafe "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Unsafe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" unsafeField"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("while")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            unsafe"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("allocateMemory")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("_1MB"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),s("h2",{attrs:{id:"å››ã€stackoverflowerror"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å››ã€stackoverflowerror"}},[a._v("#")]),a._v(" å››ã€StackOverflowError")]),a._v(" "),s("p",[a._v("å¯¹äº HotSpot è™šæ‹Ÿæœºæ¥è¯´ï¼Œæ ˆå®¹é‡åªç”± "),s("code",[a._v("-Xss")]),a._v(" å‚æ•°æ¥å†³å®šå¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ‰€å…è®¸çš„æœ€å¤§æ·±åº¦ï¼Œå°†æŠ›å‡º "),s("code",[a._v("StackOverflowError")]),a._v(" å¼‚å¸¸ã€‚")]),a._v(" "),s("p",[a._v("ä»å®æˆ˜æ¥è¯´ï¼Œæ ˆæº¢å‡ºçš„å¸¸è§åŸå› ï¼š")]),a._v(" "),s("ul",[s("li",[a._v("é€’å½’å‡½æ•°è°ƒç”¨å±‚æ•°å¤ªæ·±")]),a._v(" "),s("li",[a._v("å¤§é‡å¾ªç¯æˆ–æ­»å¾ªç¯")])]),a._v(" "),s("p",[a._v("ç¤ºä¾‹ï¼šé€’å½’å‡½æ•°è°ƒç”¨å±‚æ•°å¤ªæ·±å¯¼è‡´ "),s("code",[a._v("StackOverflowError")])]),a._v(" "),s("div",{staticClass:"language-java extra-class"},[s("pre",{pre:!0,attrs:{class:"language-java"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("StackOverflowDemo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("int")]),a._v(" stackLength "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("recursion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        stackLength"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("++")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("recursion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("static")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("void")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("main")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" args"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("StackOverflowDemo")]),a._v(" obj "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("StackOverflowDemo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("try")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("recursion")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("catch")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Throwable")]),a._v(" e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n            "),s("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("System")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("out"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("println")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"æ ˆæ·±åº¦ï¼š"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("+")]),a._v(" obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("stackLength"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n            e"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("printStackTrace")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),s("h2",{attrs:{id:"å‚è€ƒèµ„æ–™"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å‚è€ƒèµ„æ–™"}},[a._v("#")]),a._v(" å‚è€ƒèµ„æ–™")]),a._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://item.jd.com/11252778.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("ã€Šæ·±å…¥ç†è§£ Java è™šæ‹Ÿæœºã€‹"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://www.douban.com/doulist/2545443/",target:"_blank",rel:"noopener noreferrer"}},[a._v("ä»è¡¨åˆ°é‡Œå­¦ä¹  JVM å®ç°"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://www.jianshu.com/p/28935cbfbae0",target:"_blank",rel:"noopener noreferrer"}},[a._v("ä½œä¸ºæµ‹è¯•ä½ åº”è¯¥çŸ¥é“çš„ JAVA OOM åŠå®šä½åˆ†æ"),s("OutboundLink")],1)]),a._v(" "),s("li",[s("a",{attrs:{href:"https://blog.csdn.net/sinat_29912455/article/details/51125748",target:"_blank",rel:"noopener noreferrer"}},[a._v("å¼‚å¸¸ã€å †å†…å­˜æº¢å‡ºã€OOM çš„å‡ ç§æƒ…å†µ"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=e.exports}}]);